<div class="main-content" *ngIf = "!isPreviewing">
    <form [formGroup] = "quizForm">
        <div class="row header">
            <div class="col-md-12">
                <mat-form-field appearance="fill" class="input">
                    <input matInput placeholder="Add Title" formControlName = "title">
                </mat-form-field>
            </div>
            <div class="col-md-12">
                <mat-form-field appearance="fill" class="fill-in">
                    <textarea matInput placeholder="Add Description" formControlName = "description"></textarea>
                </mat-form-field>
            </div>
        </div>
    
        <div *ngIf="questionTypes.length > 0; else noQuestions" formArrayName = "questions">
            <div *ngFor="let question of questionForms.controls; let i = index"
                [formGroupName] = "i">
                <div [ngSwitch]="questionTypes[i]">
                    <!-- start listing types of questions -->
                    <div *ngSwitchCase="'Multiple Choice'">
                        <strong>Question {{i + 1}}:</strong>
                        <p>{{question.type}}</p>
                        <div> 
                            <mat-form-field appearance="fill" class="input">
                                <input matInput placeholder="Write Question Here..." formControlName = "question">
                            </mat-form-field>
                        </div>
                        <div>
                            <mat-radio-group formControlName = "answer" class="input">
                                <mat-radio-button value = "1">
                                    <mat-form-field appearance="fill">
                                        <input matInput placeholder="Option One..." formControlName = "optionOne">
                                    </mat-form-field>
                                </mat-radio-button><br>
                                <mat-radio-button value = "2">
                                    <mat-form-field appearance="fill">
                                        <input matInput placeholder="Option Two..." formControlName = "optionTwo">
                                    </mat-form-field>
                                </mat-radio-button><br>
                                <mat-radio-button value = "3">
                                    <mat-form-field appearance="fill">
                                        <input matInput placeholder="Option Three..." formControlName = "optionThree">
                                    </mat-form-field>
                                </mat-radio-button><br>
                                <mat-radio-button value = "4">
                                    <mat-form-field appearance="fill">
                                        <input matInput placeholder="Option Four..." formControlName = "optionFour">
                                    </mat-form-field>
                                </mat-radio-button><br>
                            </mat-radio-group>
                        </div>
                        <div>
                            Points: 
                            <mat-form-field appearance="fill" class="points">
                                <input matInput placeholder="" formControlName = "value">
                            </mat-form-field>
                            <span *ngIf="question.controls.value.errors?.pattern">
                                Only positive whole numbers accepted!
                            </span>
                        </div>
                        <div>
                            <button mat-raised-button (click)="deleteQuestion(i)">Delete question</button>
                        </div>
                        <br>
                    </div>
                    
                    <div *ngSwitchCase="'True/False'">
                        <strong>Question {{i + 1}}:</strong>
                        <p>{{question.type}}</p>
                        <div>
                            <mat-form-field appearance="fill" class="input">
                                <input matInput placeholder="Write Question Here..." formControlName = "question">
                            </mat-form-field>
                        </div>
                        <div>
                            <mat-radio-group formControlName = "answer">
                                <mat-radio-button value = "true">True</mat-radio-button><br>
                                <mat-radio-button value = "false">False</mat-radio-button>
                            </mat-radio-group>
                        </div>
                        <div>
                            Points: 
                            <mat-form-field appearance="fill" class="points">
                                <input matInput placeholder="" formControlName = "value">
                            </mat-form-field>
                            <span *ngIf="question.controls.value.errors?.pattern">
                                Only positive whole numbers accepted!
                            </span>
                        </div>
                        <div>
                            <button mat-raised-button (click)="deleteQuestion(i)">Delete question</button>
                        </div>
                        <br>
                    </div>

                    <div *ngSwitchCase="'Short Answer'" >
                        <strong>Question {{i + 1}}:</strong>
                        <p>{{question.type}}</p>
                        <div>
                            <mat-form-field appearance="fill" class="input">
                                <input matInput placeholder="Write Question Here..." formControlName = "question">
                            </mat-form-field>
                        </div>
                        <div>
                            <mat-form-field appearance="fill" class="input">
                                <input matInput placeholder="Answer Goes Here..." formControlName = "answer">
                            </mat-form-field>
                            <span *ngIf="question.controls.answer.errors?.maxlength">
                                    The maximum character limit is 100!
                            </span>
                        </div>
                        <div>
                            Points: 
                            <mat-form-field appearance="fill" class="points">
                                <input matInput placeholder="" formControlName = "value">
                            </mat-form-field>
                            <span *ngIf="question.controls.value.errors?.pattern">
                                Only positive whole numbers accepted!
                            </span>
                        </div>
                        <div>
                            <button mat-raised-button (click)="deleteQuestion(i)">Delete question</button>
                        </div>
                        <br>
                    </div>

                    <div *ngSwitchCase="'Essay'" >
                        <strong>Question {{i + 1}}:</strong>
                        <p>{{question.type}}</p>
                        <div>
                            <mat-form-field appearance="fill" class="input">
                                <input matInput placeholder="Write Question Here..." formControlName = "question">
                            </mat-form-field>
                        </div>
                        <div>
                            <mat-form-field appearance="fill" class="fill-in">
                                <textarea matInput placeholder="Answer Goes Here..." formControlName = "answer">
                                </textarea>
                            </mat-form-field>
                            <span *ngIf="question.controls.answer.errors?.maxlength">
                                The maximum character limit is 500!
                            </span>
                        </div>
                        <div>
                            Points: 
                            <mat-form-field appearance="fill" class="points">
                                <input matInput placeholder="" formControlName = "value">
                            </mat-form-field>
                            <span *ngIf="question.controls.value.errors?.pattern">
                                    Only positive whole numbers accepted!
                            </span>
                        </div>
                        <div>
                            <button mat-raised-button (click)="deleteQuestion(i)">Delete question</button>
                        </div>
                        <br>
                    </div>

                    <div *ngSwitchCase="'Ranking'" >
                        <strong>Question {{i + 1}}:</strong>
                        <p>{{question.type}}</p>
                        <div>
                            <mat-form-field appearance="fill" class="input">
                                <input matInput placeholder="Write Question Here..." formControlName = "question">
                            </mat-form-field>
                        </div>
                        <div>
                            <!-- <mat-form-field appearance="fill" class="fill-in">
                                <textarea matInput placeholder="Answer Goes Here..." formControlName = "answer">
                                </textarea>
                            </mat-form-field> -->
                            <!-- <span *ngIf="question.controls.answer.errors?.maxlength">
                                The maximum character limit is 500!
                            </span> -->
                            <div cdkDropList class="example-list" (cdkDropListDropped)="drop($event, i)">
                            <div *ngFor="let item of question.get('options').controls" [formGroup] = "item" cdkDrag>
                                <!-- <span cdkDragHandle>drag</span> -->
                                <mat-form-field appearance="fill" class="input">
                                <input matInput placeholder="Option..." formControlName="option">
                                </mat-form-field>
                            </div>
                            </div>
                        </div>
                        <div>
                            Points: 
                            <mat-form-field appearance="fill" class="points">
                                <input matInput placeholder="" formControlName = "value">
                            </mat-form-field>
                            <span *ngIf="question.controls.value.errors?.pattern">
                                    Only positive whole numbers accepted!
                            </span>
                        </div>
                        <div>
                            <button mat-raised-button (click)="deleteQuestion(i)">Delete question</button>
                        </div>
                        <br>
                    </div>
                </div>
            </div>
        </div>
        <ng-template #noQuestions>
            <p>Add a question to get started...</p>
        </ng-template>
    
    
    <button mat-raised-button (click)="addMultipleChoice()">Add Multiple Choice</button>
    <button mat-raised-button (click)="addTrueFalse()">Add True/False</button>
    <button mat-raised-button (click)="addShortAnswer()">Add Short Answer</button>
    <button mat-raised-button (click)="addEssay()">Add Essay</button><br>
    <button mat-raised-button (click)="addRanking()">Add Ranking</button><br>
    <br>
    <div *ngIf="quizForm.invalid">
            <p> 
                All fields must be filled out correctly before you can preview!
            </p>
        </div> 
        <div *ngIf="quizForm.valid">
                <p> 
                    You can now preview!
                </p>
            </div> 
        <button mat-raised-button [disabled] = "quizForm.invalid" (click)="togglePreview()" id="preview">Preview</button>
</form>

</div>
<div *ngIf ="isPreviewing">
        <button mat-raised-button (click)="togglePreview()" id="preview">Edit</button>
        <button mat-raised-button (click)="submit()" id="preview">Submit</button>
    <h1><br>{{data.title}}</h1>
    <h4>{{data.description}}</h4>
    <div *ngFor="let question of data.questions; let i = index">
        <div [ngSwitch] = "questionTypes[i]">
            <div *ngSwitchCase = "'Multiple Choice'">
                <strong>{{i + 1}}. {{question.question}}</strong>
                <div>
                    <mat-radio-group value = question.answer>
                        <mat-radio-button value = "1">
                            {{question.optionOne}}
                        </mat-radio-button><br>
                        <mat-radio-button value = "2">
                            {{question.optionTwo}}
                        </mat-radio-button><br>
                        <mat-radio-button value = "3">
                            {{question.optionThree}}
                        </mat-radio-button><br>
                        <mat-radio-button value = "4">
                            {{question.optionFour}}
                        </mat-radio-button><br>
                    </mat-radio-group>
                </div>
            </div>
            <div *ngSwitchCase = "'True/False'">
                <strong>{{i + 1}}. {{question.question}}</strong>
                <div>
                    <mat-radio-group value = question.answer>
                        <mat-radio-button value = "true">True</mat-radio-button><br>
                        <mat-radio-button value = "false">False</mat-radio-button>
                    </mat-radio-group>
                </div>
            </div>
            <div *ngSwitchCase = "'Short Answer'">
                <strong>{{i + 1}}. {{question.question}}</strong>
                <div>
                    <mat-form-field appearance="fill" class="input">
                        <input matInput placeholder="Answer Goes Here...">
                    </mat-form-field>
                </div>
            </div>
            <div *ngSwitchCase = "'Essay'">
                <strong>{{i + 1}}. {{question.question}}</strong>
                <div>
                    <mat-form-field appearance="fill" class="fill-in">
                        <textarea matInput placeholder="Answer Goes Here...">
                        </textarea>
                    </mat-form-field>
                </div>
            </div>
        </div>
    </div>
</div>